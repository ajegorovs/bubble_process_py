TODO:
27.09.23 implement final pass / extension of segment start/end 
27.09.23 extension of split branches havent been done yet. no test data

DONE:
